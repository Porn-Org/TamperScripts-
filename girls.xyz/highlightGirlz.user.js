// ==UserScript==
// @name          Hightlight girls
// @namespace     PornOrg
// @version       0.1
// @description   Highlight chosen girls in list
// @author        pornoShik

// @match         https://rt.girls.xyz/
// @match         https://rt.girls.xyz/couples

// @icon          data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/Pg0KPCEtLSBVcGxvYWRlZCB0bzogU1ZHIFJlcG8sIHd3dy5zdmdyZXBvLmNvbSwgR2VuZXJhdG9yOiBTVkcgUmVwbyBNaXhlciBUb29scyAtLT4NCjxzdmcNCgl2ZXJzaW9uPSIxLjEiDQoJaWQ9IkxheWVyXzEiDQoJeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIg0KCXhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIg0KCXZpZXdCb3g9IjAgMCA1MTIgNTEyIg0KCXhtbDpzcGFjZT0icHJlc2VydmUiPg0KDQo8cGF0aCBzdHlsZT0iZmlsbDojRUM1ODlCOyIgZD0iTTM3OS45MTQsMTc2LjAzNGwzNi41NjUtMzYuNTY1bDQyLjIyOSw0Mi4yMjlsNDMuOTQ4LTQzLjk0OGwtNDIuMjI5LTQyLjIyOWw0Mi4yMjktNDIuMjI5DQoJTDQ1OC43MDgsOS4zNDVsLTQyLjIyOSw0Mi4yMjlMMzc0LjI1LDkuMzQ1bC00My45NDgsNDMuOTQ4bDQyLjIyOSw0Mi4yMjlsLTM2LjU2NSwzNi41NjUNCgljLTgwLjI1Mi01OS4wMDktMTk0LjA1NS01Mi4yNC0yNjYuNjA3LDIwLjMxM2MtODAuMDE5LDgwLjAxOS04MC4wMTksMjEwLjIyMiwwLDI5MC4yNDJzMjEwLjIyMiw4MC4wMTksMjkwLjI0MiwwDQoJQzQzMi4xNTMsMzcwLjA4OSw0MzguOTIzLDI1Ni4yODYsMzc5LjkxNCwxNzYuMDM0eiBNMTEzLjMwOCwzOTguNjkzYy01NS43ODctNTUuNzg3LTU1Ljc4Ny0xNDYuNTU5LDAtMjAyLjM0NQ0KCXMxNDYuNTU5LTU1Ljc4NywyMDIuMzQ3LDBjNTUuNzg3LDU1Ljc4Nyw1NS43ODcsMTQ2LjU1OSwwLDIwMi4zNDVTMTY5LjA5NSw0NTQuNDgsMTEzLjMwOCwzOTguNjkzeiIvPg0KPHBhdGggZD0iTTE5MC44OTQsMTAzLjE0YzQ5Ljg0NC01Ljk5Miw5OS40LDYuOTYxLDEzOS41MzYsMzYuNDc0YzEuNjU3LDEuMjE5LDMuNiwxLjgxNyw1LjUzMiwxLjgxNw0KCWMyLjQwNywwLDQuODAxLTAuOTI3LDYuNjExLTIuNzM3bDM2LjU2NS0zNi41NjVjMy42NDktMy42NDksMy42NDktOS41NjYsMC0xMy4yMTRsLTM1LjYyLTM1LjYyMWwzMC43MzQtMzAuNzM0bDM1LjYyMSwzNS42Mg0KCWMzLjY0OSwzLjY0OSw5LjU2NiwzLjY0OSwxMy4yMTQsMGwzNS42Mi0zNS42MmwzMC43MzQsMzAuNzM0bC0zLjk0NywzLjk0N2MtMy42NDksMy42NDktMy42NDksOS41NjYsMCwxMy4yMTQNCgljMy42NDksMy42NDksOS41NjYsMy42NDksMTMuMjE0LDBMNTA5LjI2Myw1OS45YzMuNjQ5LTMuNjQ5LDMuNjQ5LTkuNTY2LDAtMTMuMjE0TDQ2NS4zMTUsMi43MzdjLTMuNjQ4LTMuNjUxLTkuNTY1LTMuNjQ5LTEzLjIxNCwwDQoJbC0zNS42MiwzNS42MmwtMzUuNjIxLTM1LjYyYy0zLjY0OS0zLjY0OS05LjU2Ni0zLjY0OS0xMy4yMTQsMGwtNDMuOTQ5LDQzLjk0OGMtMy42NDksMy42NDktMy42NDksOS41NjYsMCwxMy4yMTRsMzUuNjIsMzUuNjIxDQoJbC0yNC4zODksMjQuMzg5Yy00Mi43NTMtMjkuMDQtOTQuMzcyLTQxLjU2Ny0xNDYuMjYyLTM1LjMyNWMtNS4xMjUsMC42MTYtOC43NzksNS4yNjktOC4xNjIsMTAuMzkyDQoJQzE4MS4xMTcsMTAwLjEwMSwxODUuNzY1LDEwMy43NTYsMTkwLjg5NCwxMDMuMTR6Ii8+DQo8cGF0aCBkPSJNNDczLjY0Myw5NS41MjFsNC41MDgtNC41MDhjMy42NDktMy42NDksMy42NDktOS41NjYsMC0xMy4yMTRjLTMuNjQ5LTMuNjUxLTkuNTY2LTMuNjQ5LTEzLjIxNCwwbC0xMS4xMTUsMTEuMTE1DQoJYy0zLjY0OSwzLjY0OS0zLjY0OSw5LjU2NiwwLDEzLjIxNGwzNS42MiwzNS42MmwtMzAuNzM0LDMwLjczNGwtMzUuNjItMzUuNjJjLTMuNjQ4LTMuNjQ5LTkuNTY1LTMuNjQ5LTEzLjIxNCwwbC0zNi41NjYsMzYuNTY1DQoJYy0zLjI2NCwzLjI2NC0zLjY1Niw4LjQyNC0wLjkyMSwxMi4xNDNjMjcuNDIyLDM3LjI5Myw0MC43LDgzLjQ1OSwzNy4zODcsMTI5Ljk5MWMtMy4zNDcsNDYuOTk5LTIzLjUxMSw5MS4yMDQtNTYuNzc5LDEyNC40NzINCgljLTM2LjkzNiwzNi45MzYtODYuMTI3LDU3LjI3Ny0xMzguNTEyLDU3LjI3N3MtMTAxLjU3OC0yMC4zNDEtMTM4LjUxNC01Ny4yNzdjLTM2LjkzNy0zNi45MzYtNTcuMjgtODYuMTI4LTU3LjI4LTEzOC41MTQNCglzMjAuMzQxLTEwMS41NzYsNTcuMjc4LTEzOC41MTRjMjIuOTM4LTIyLjkzOCw1MS40MjQtMzkuOTI1LDgyLjM3OS00OS4xMjZjNC45NDgtMS40Nyw3Ljc2NS02LjY3Miw2LjI5NC0xMS42Mg0KCXMtNi42NzEtNy43NjctMTEuNjItNi4yOTRjLTMzLjkyNiwxMC4wODMtNjUuMTQsMjguNjk2LTkwLjI3LDUzLjgyNkMyMi4yODYsMTg2LjI1NywwLDI0MC4xNDIsMCwyOTcuNTE5DQoJYzAsNTcuMzc4LDIyLjI4NiwxMTEuMjYyLDYyLjc1MywxNTEuNzI5QzEwMy4yMTksNDg5LjcxNSwxNTcuMTA0LDUxMiwyMTQuNDgxLDUxMnMxMTEuMjYyLTIyLjI4NSwxNTEuNzI4LTYyLjc1Mg0KCWMzNi40NDktMzYuNDQ3LDU4LjUzOS04NC44NzYsNjIuMjA1LTEzNi4zNTljMy40MzUtNDguMjU2LTkuNDMxLTk2LjE2NC0zNi4zMjUtMTM1LjgxNGwyNC4zOTItMjQuMzkxbDM1LjYyLDM1LjYyDQoJYzMuNjQ5LDMuNjQ5LDkuNTY2LDMuNjQ5LDEzLjIxNCwwbDQzLjk0OC00My45NDhjMy42NDktMy42NDksMy42NDktOS41NjYsMC0xMy4yMTRMNDczLjY0Myw5NS41MjF6Ii8+DQo8cGF0aCBkPSJNMTA2LjcsMTg5LjczOWMtMjguNzQ2LDI4Ljc0Ni00NC41NzcsNjcuMDIzLTQ0LjU3NywxMDcuNzhzMTUuODMyLDc5LjAzNSw0NC41NzcsMTA3Ljc4czY3LjAyMyw0NC41NzcsMTA3Ljc4LDQ0LjU3Nw0KCXM3OS4wMzQtMTUuODMxLDEwNy43OC00NC41NzdjNTkuNDMtNTkuNDMsNTkuNDMxLTE1Ni4xMzEsMC0yMTUuNTYxUzE2Ni4xMywxMzAuMzEsMTA2LjcsMTg5LjczOXogTTMwOS4wNDYsMzkyLjA4Ng0KCWMtNTIuMTQ0LDUyLjE0My0xMzYuOTg3LDUyLjE0NC0xODkuMTMsMGMtMjUuMjE3LTI1LjIxNy0zOS4xMDQtNTguODAxLTM5LjEwNC05NC41NjZjMC0zNS43NjYsMTMuODg3LTY5LjM0OSwzOS4xMDMtOTQuNTY2DQoJczU4LjgtMzkuMTA0LDk0LjU2Ni0zOS4xMDRzNjkuMzUsMTMuODg3LDk0LjU2NiwzOS4xMDRjMjUuMjE1LDI1LjIxNywzOS4xMDMsNTguOCwzOS4xMDMsOTQuNTY2UzMzNC4yNjIsMzY2Ljg2OSwzMDkuMDQ2LDM5Mi4wODZ6Ig0KCS8+DQo8L3N2Zz4=

// @grant         none
// @grant         GM_xmlhttpRequest
// @grant         GM_openInTab
// @grant         GM_registerMenuCommand
// ==/UserScript==


var http = new XMLHttpRequest();
var tempdoc = new DOMParser();


let girlsMap = new Map();
//real
// girlsMap['girlUID'] = {"Do":"Highlight", "Tags":["popLar"], "Color":"Yellow", 'MoveUp':0};

let FocusMode = false;

function ProcessCardsList(aList, method, methodParameters)
{
    console.log('PornOrg: processing list');
    console.log('items count: ' + aList.length.toString());

    let notify = [];
    let context = {};

    for (let idx = 0; idx < aList.length; idx++ )
    {
        let aCard = aList[idx];
        method(aCard, methodParameters, context);
    }

    if (Object.keys(context).includes('MoveUp'))
    {
        let Cams = Object.keys(context.MoveUp);

    }

    if (notify.length > 0)
    {
        alert("Here: " + notify.join(", "));
    }

}




function ProcessOneCard(aCard, aParameters, acontext)
{
    let defProfile = {};
    defProfile.Do = "";

    let tagLine = aCard.getElementsByClassName('lst_tags')[0];
    if (tagLine)
    {
        let TagList = tagLine.getElementsByTagName('a');
        for (const tagitem of TagList)
        {
            //tagitem.style.backgroundColor = "transparent";
            //tagitem.style.border = "none;";
            //tagitem.classList.remove('bc_hash_tag');
            tagitem.parentNode.removeChild(tagitem);
        }
    }

    let ahref = aCard.getElementsByTagName('a')[0];
    if (ahref)
    {
        let url = ahref.getAttribute('href');
        let modelName = ahref.dataset.chathost;

        console.log("PornOrg: see a model: " + modelName);

        let mp = Object.keys(girlsMap);
        let idx = mp.indexOf(modelName);
        if (idx != -1)
        {
            let profileAction = girlsMap[modelName];
            console.log("PornOrg: Found: " + JSON.stringify( profileAction ));

            if ([])
            if (profileAction.Do == "Highlight")
            {
                defProfile.Do = profileAction.Do;
                defProfile.Params = profileAction;
            }

            if (profileAction.Do == "Hide")
            {
                defProfile.Do = profileAction.Do;
            }

            if (Object.keys(profileAction).includes('Tags'))
            {
                let TagList = tagLine.getElementsByTagName('span');
                for (const tagitem of TagList)
                {
                    tagitem.parentNode.removeChild(tagitem);
                }

                let sp = document.createElement('span');
                sp.innerHTML = profileAction.Tags[0];
                tagLine.append(sp);
            }
        }
    }

    if (FocusMode)
    {
        if (defProfile.Do != "Highlight")
        {
            defProfile.Do = "Hide";
        }
    }

    if (defProfile.Do == "Highlight")
    {
        let highColor = "Red";
        if (Object.keys(defProfile.Params).includes('Color'))
            highColor = defProfile.Params.Color;

        aCard.style.backgroundColor = highColor;

        aCard.style.minWidth = 640
        aCard.style.minHeight = 480;

        if (Object.keys(defProfile.Params).includes('MoveUp'))
        {

            if (!acontext.MoveUp)
                acontext.MoveUp = {};
            if (!acontext.MoveUp[defProfile.Params.MoveUp])
                acontext.MoveUp[defProfile.Params.MoveUp] = [];

            acontext.MoveUp[defProfile.Params.MoveUp].push(aCard);

            aCard.parentNode.prepend(aCard);
        }
    }
    else
    {
        aCard.style.backgroundColor = "transparent";
    }


    if (defProfile.Do == "Hide")
    {
        //aCard.style.display = "none";
        aCard.style.visibility = "hidden";
        aCard.parentNode.removeChild(aCard);
    }
    else
    {
        aCard.style.visibility = "";
        //aCard.style.display = "";
    }

    aCard.style.padding = "3px";

    return true;
}


let notified = [];

function getcontent(url)
{
    try
    {
        http.open('GET', url+'&tmp='+Math.random(), false);
        http.send(null);
    }
    catch(e)
    { return null; };

    if (http.status == 200){
        return tempdoc.parseFromString(http.responseText, 'text/html');
    }
    return null;
}

function getCards(rootNode, className = 'mls_models')
{
    var allList = rootNode.getElementsByClassName(className);
    return allList;
}

document.Total = 0;
console.log('PornOrg: started');

let updTimer = false;

function onUpdated()
{
    let cardsList = getCards(document.getElementById('mls_models'), 'ls_thumb');

    ProcessCardsList(cardsList, ProcessOneCard, {field: "sdfsdf"});

    let banners = document.getElementById('mls_models');
    banners = banners.getElementsByClassName('ls_catrow')

    for (let idx = 0; idx < banners.length; idx++ )
    {
        let banner = banners[idx];
        banner.style.display = "none";
    }

    //    document.Total = document.Total + 1;
    //    document.title = document.Total;
}


var observer = new MutationObserver(
    function(mutations)
    {
        mutations.forEach(function(mutation)
                          {
            if ((mutation.type == "childList"))
            {
                if (updTimer)
                {
                    clearTimeout(updTimer);
                }

                updTimer = setTimeout(onUpdated, 33);

                console.log("pda: an element has been added!");
            }
        });
    });

var target = document.getElementById('mls_models');
target.style.backgroundColor = "#333";


// this for later features
//var LoveBtn = document.getElementById('bLovers');



var config = { childList: true, subtree: true}; //, subtree: true //attributes: true

observer.observe(target, config);
